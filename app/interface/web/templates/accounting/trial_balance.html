<!DOCTYPE html>
<html lang="ca">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balanç de Comprovació - ERP Català</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body>
    <nav>
        <div style="font-weight: 700; font-size: 1.2rem;">ERP Català</div>
        <div>
            <a href="/">Inici</a>
            <a href="/accounting">Comptabilitat</a>
        </div>
    </nav>

    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h1>Balanç de Comprovació</h1>
            <div>
                <a href="/accounting/journal" class="btn" style="margin-right: 1rem;">Llibre Diari</a>
                <a href="/accounts/" class="btn">Pla Comptable</a>
            </div>
        </div>

        <div class="card">
            {% if trial_balance %}
            <table>
                <thead>
                    <tr>
                        <th>Codi</th>
                        <th>Compte</th>
                        <th>Tipus</th>
                        <th style="text-align: right;">Saldo Deutor</th>
                        <th style="text-align: right;">Saldo Creditor</th>
                    </tr>
                </thead>
                <tbody>
                    {% set ns = namespace(total_debit=0, total_credit=0) %}
                    {% for code, data in trial_balance.items() %}
                    <tr>
                        <td><strong><a href="/accounting/ledger/{{ code }}"
                                    style="text-decoration: none; color: var(--accent-color);">{{ code }}</a></strong>
                        </td>
                        <td>{{ data.name }}</td>
                        <td>{{ data.type }}</td>
                        <td class="amount text-success">
                            {% if data.balance > 0 %}
                            {{ "%.2f"|format(data.balance) }} €
                            {% set ns.total_debit = ns.total_debit + data.balance %}
                            {% endif %}
                        </td>
                        <td class="amount text-danger">
                            {% if data.balance < 0 %} {{ "%.2f" |format(data.balance|abs) }} € {% set
                                ns.total_credit=ns.total_credit + data.balance|abs %} {% endif %} </td>
                    </tr>
                    {% endfor %}
                    <tr class="total-row">
                        <td colspan="3" style="text-align: right; padding-right: 1rem;">Totals:</td>
                        <td class="amount text-success">{{ "%.2f"|format(ns.total_debit) }} €</td>
                        <td class="amount text-danger">{{ "%.2f"|format(ns.total_credit) }} €</td>
                    </tr>
                </tbody>
            </table>
            {% else %}
            <p style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                No hi ha dades per mostrar.
            </p>
            {% endif %}
        </div>
    </div>
</body>

</html>